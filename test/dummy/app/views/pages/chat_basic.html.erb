<div class="container mx-auto max-w-4xl p-4">
  <%= render FlatPack::PageTitle::Component.new(title: "Chat Component - Basic Demo") %>
  <%= render "pages/component_method_variables_table", component: :chat_panel %>
  
  <div class="bg-white dark:bg-zinc-900 rounded-lg shadow-lg border border-[var(--color-border)]" style="height: 600px">
    <%= render(FlatPack::Chat::Panel::Component.new) do |panel| %>
      <% panel.with_header do %>
        <div class="p-4 flex items-center justify-between">
          <div>
            <h2 class="text-lg font-semibold text-[var(--color-foreground)]">Team Chat</h2>
            <p class="text-sm text-[var(--color-muted-foreground)]">3 participants</p>
          </div>
          <%= render(FlatPack::AvatarGroup::Component.new(
            items: [
              { name: "Alice", initials: "AL" },
              { name: "Bob", initials: "BW" },
              { name: "Charlie", initials: "CD" }
            ],
            size: :sm,
            max: 3
          )) %>
        </div>
      <% end %>

      <% panel.with_messages do %>
        <div class="flex-1 overflow-y-auto p-4 space-y-3 sm:space-y-4" style="height: 400px">
          <%= render(FlatPack::Chat::DateDivider::Component.new(label: "Today")) %>

          <%= render(FlatPack::Chat::MessageGroup::Component.new(
            direction: :incoming,
            show_avatar: true,
            show_name: true,
            sender_name: "Alice"
          )) do |group| %>
            <% group.with_avatar do %>
              <%= render(FlatPack::Avatar::Component.new(
                name: "Alice",
                initials: "AL",
                size: :sm
              )) %>
            <% end %>

            <% group.with_message do %>
              <%= render(FlatPack::Chat::Message::Component.new(
                direction: :incoming,
                timestamp: Time.parse("10:30 AM")
              )) do |msg| %>
                Hey team! Have you seen the new designs?
                <% msg.with_meta do %>
                  <%= render(FlatPack::Chat::MessageMeta::Component.new(
                    timestamp: Time.parse("10:30 AM"),
                    state: :read
                  )) %>
                <% end %>
              <% end %>
            <% end %>

            <% group.with_message do %>
              <%= render(FlatPack::Chat::Message::Component.new(
                direction: :incoming,
                timestamp: Time.parse("10:30 AM")
              )) do |msg| %>
                I think they look great! üé®
                <% msg.with_meta do %>
                  <%= render(FlatPack::Chat::MessageMeta::Component.new(
                    timestamp: Time.parse("10:30 AM"),
                    state: :read
                  )) %>
                <% end %>
              <% end %>
            <% end %>
          <% end %>

          <%= render(FlatPack::Chat::MessageGroup::Component.new(
            direction: :outgoing,
            show_avatar: false
          )) do |group| %>
            <% group.with_message do %>
              <%= render(FlatPack::Chat::Message::Component.new(
                direction: :outgoing,
                timestamp: Time.parse("10:32 AM")
              )) do |msg| %>
                Yes! I'm reviewing them now.
                <% msg.with_meta do %>
                  <%= render(FlatPack::Chat::MessageMeta::Component.new(
                    timestamp: Time.parse("10:32 AM"),
                    state: :read
                  )) %>
                <% end %>
              <% end %>
            <% end %>
          <% end %>

          <%= render(FlatPack::Chat::MessageGroup::Component.new(
            direction: :incoming,
            show_avatar: true,
            show_name: true,
            sender_name: "Bob"
          )) do |group| %>
            <% group.with_avatar do %>
              <%= render(FlatPack::Avatar::Component.new(
                name: "Bob Wilson",
                initials: "BW",
                size: :sm
              )) %>
            <% end %>

            <% group.with_message do %>
              <%= render(FlatPack::Chat::Message::Component.new(
                direction: :incoming,
                timestamp: Time.parse("10:35 AM")
              )) do |msg| %>
                I've attached the latest mockups for reference
                <% msg.with_attachment do %>
                  <%= render(FlatPack::Chat::Attachment::Component.new(
                    type: :file,
                    name: "design-mockups-v2.pdf",
                    meta: "2.4 MB",
                    href: "#"
                  )) %>
                <% end %>
                <% msg.with_meta do %>
                  <%= render(FlatPack::Chat::MessageMeta::Component.new(
                    timestamp: Time.parse("10:35 AM"),
                    state: :read
                  )) %>
                <% end %>
              <% end %>
            <% end %>
          <% end %>

          <%= render(FlatPack::Chat::MessageGroup::Component.new(
            direction: :incoming,
            show_avatar: true,
            show_name: true,
            sender_name: "Alice"
          )) do |group| %>
            <% group.with_avatar do %>
              <%= render(FlatPack::Avatar::Component.new(
                name: "Alice",
                initials: "AL",
                size: :sm
              )) %>
            <% end %>

            <% group.with_message do %>
              <%= render(FlatPack::Chat::Message::Component.new(
                direction: :incoming,
                timestamp: Time.parse("10:38 AM")
              )) do |msg| %>
                Here's the hero image we discussed
                <% msg.with_attachment do %>
                  <%= render(FlatPack::Chat::Attachment::Component.new(
                    type: :image,
                    name: "hero-design.png",
                    thumbnail_url: "https://images.unsplash.com/photo-1618005182384-a83a8bd57fbe?w=400&h=300&fit=crop",
                    href: "#"
                  )) %>
                <% end %>
                <% msg.with_meta do %>
                  <%= render(FlatPack::Chat::MessageMeta::Component.new(
                    timestamp: Time.parse("10:38 AM"),
                    state: :read
                  )) %>
                <% end %>
              <% end %>
            <% end %>
          <% end %>

          <%= render(FlatPack::Chat::MessageGroup::Component.new(
            direction: :outgoing,
            show_avatar: false
          )) do |group| %>
            <% group.with_message do %>
              <%= render(FlatPack::Chat::Message::Component.new(
                direction: :outgoing,
                timestamp: Time.parse("10:40 AM")
              )) do |msg| %>
                Perfect! This is exactly what we need üëç
                <% msg.with_meta do %>
                  <%= render(FlatPack::Chat::MessageMeta::Component.new(
                    timestamp: Time.parse("10:40 AM"),
                    state: :read
                  )) %>
                <% end %>
              <% end %>
            <% end %>

            <% group.with_message do %>
              <%= render(FlatPack::Chat::Message::Component.new(
                direction: :outgoing,
                timestamp: Time.parse("10:40 AM")
              )) do |msg| %>
                Let's move forward with this design.
                <% msg.with_meta do %>
                  <%= render(FlatPack::Chat::MessageMeta::Component.new(
                    timestamp: Time.parse("10:40 AM"),
                    state: :read
                  )) %>
                <% end %>
              <% end %>
            <% end %>
          <% end %>

          <%= render(FlatPack::Chat::TypingIndicator::Component.new(
            label: "Alice is typing"
          )) do |indicator| %>
            <% indicator.with_avatar do %>
              <%= render(FlatPack::Avatar::Component.new(
                name: "Alice",
                initials: "AL",
                size: :sm
              )) %>
            <% end %>
          <% end %>
        </div>
      <% end %>

      <% panel.with_composer do %>
        <%= render(FlatPack::Chat::Composer::Component.new) do |composer| %>
          <% composer.with_textarea do %>
            <%= render(FlatPack::Chat::Textarea::Component.new(
              placeholder: "Type your message...",
              autogrow: true,
              submit_on_enter: true
            )) %>
          <% end %>
          <% composer.with_actions do %>
            <%= render(FlatPack::Chat::SendButton::Component.new) %>
          <% end %>
        <% end %>
      <% end %>
    <% end %>
  </div>

  <div class="mt-4 text-sm text-[var(--color-muted-foreground)]">
    <p><strong>Features shown:</strong></p>
    <ul class="list-disc list-inside space-y-1 mt-2">
      <li>Full chat panel with header, messages, and composer</li>
      <li>Avatar group showing participants in header</li>
      <li>Message groups with avatars and sender names</li>
      <li>Multiple messages in a single group</li>
      <li>Date divider separating sections</li>
      <li>File and image attachments with thumbnails</li>
      <li>Typing indicator with avatar</li>
      <li>Working composer with textarea and send button</li>
    </ul>
  </div>
</div>
