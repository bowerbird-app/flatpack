<%= render FlatPack::PageTitle::Component.new(
  title: "Chart Component",
  subtitle: "Data visualization using ApexCharts with Card wrapping by default."
) %>

<%= render "pages/component_method_variables_table", component: :chart %>

<%
  erb_open = "<" + "%"
  erb_output_open = "<" + "%="
  erb_tag_close = "%" + ">"
%>

<!-- Basic Line Chart -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Line Chart", anchor_link: true, subtitle: "Examples for Line Chart.") %>
  <%= render FlatPack::Chart::Component.new(
    type: :line,
    series: [{
      name: "Sales",
      data: [30, 40, 45, 50, 49, 60, 70, 91, 125, 150, 180, 200]
    }],
    title: "Monthly Sales",
    height: 300
  ) %>

  <%= render FlatPack::CodeBlock::Component.new(
    title: "ERB",
    language: "erb",
    code: <<~CODE
      #{erb_output_open} render FlatPack::Chart::Component.new(
        type: :line,
        series: [{
          name: "Sales",
          data: [30, 40, 45, 50, 49, 60, 70, 91, 125, 150, 180, 200]
        }],
        title: "Monthly Sales",
        height: 300
      ) #{erb_tag_close}
    CODE
  ) %>
</section>

<!-- Bar Chart -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Bar Chart", anchor_link: true, subtitle: "Examples for Bar Chart.") %>
  <%= render FlatPack::Chart::Component.new(
    type: :bar,
    series: [{
      name: "Revenue",
      data: [44, 55, 57, 56, 61, 58, 63, 60, 66, 71, 89, 95]
    }],
    title: "Quarterly Revenue",
    subtitle: "In thousands",
    height: 300
  ) %>

  <%= render FlatPack::CodeBlock::Component.new(
    title: "ERB",
    language: "erb",
    code: <<~CODE
      #{erb_output_open} render FlatPack::Chart::Component.new(
        type: :bar,
        series: [{
          name: "Revenue",
          data: [44, 55, 57, 56, 61, 58, 63, 60, 66, 71, 89, 95]
        }],
        title: "Quarterly Revenue",
        subtitle: "In thousands",
        height: 300
      ) #{erb_tag_close}
    CODE
  ) %>
</section>

<!-- Area Chart -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Area Chart", anchor_link: true, subtitle: "Examples for Area Chart.") %>
  <%= render FlatPack::Chart::Component.new(
    type: :area,
    series: [
      {name: "Series 1", data: [31, 40, 28, 51, 42, 109, 100]},
      {name: "Series 2", data: [11, 32, 45, 32, 34, 52, 41]}
    ],
    title: "Multi-Series Area Chart",
    height: 300
  ) %>

  <%= render FlatPack::CodeBlock::Component.new(
    title: "ERB",
    language: "erb",
    code: <<~CODE
      #{erb_output_open} render FlatPack::Chart::Component.new(
        type: :area,
        series: [
          {name: "Series 1", data: [31, 40, 28, 51, 42, 109, 100]},
          {name: "Series 2", data: [11, 32, 45, 32, 34, 52, 41]}
        ],
        title: "Multi-Series Area Chart",
        height: 300
      ) #{erb_tag_close}
    CODE
  ) %>
</section>

<!-- Donut Chart -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Donut Chart", anchor_link: true, subtitle: "Examples for Donut Chart.") %>
  <%= render FlatPack::Chart::Component.new(
    type: :donut,
    series: [44, 55, 41, 17, 15],
    title: "Distribution",
    height: 350,
    options: {
      labels: ['Apple', 'Orange', 'Banana', 'Mango', 'Grape']
    }
  ) %>

  <%= render FlatPack::CodeBlock::Component.new(
    title: "ERB",
    language: "erb",
    code: <<~CODE
      #{erb_output_open} render FlatPack::Chart::Component.new(
        type: :donut,
        series: [44, 55, 41, 17, 15],
        title: "Distribution",
        height: 350,
        options: {
          labels: ["Apple", "Orange", "Banana", "Mango", "Grape"]
        }
      ) #{erb_tag_close}
    CODE
  ) %>
</section>

<!-- Chart with Actions -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Chart with Actions", anchor_link: true, subtitle: "Examples for Chart with Actions.") %>
  <%= render FlatPack::Chart::Component.new(
    type: :line,
    series: [{name: "Users", data: [10, 25, 42, 68, 95, 130, 178, 220]}],
    title: "User Growth",
    subtitle: "Last 8 months",
    height: 300
  ) do |chart| %>
    <% chart.actions do %>
      <%= render FlatPack::Button::Component.new(text: "Export", style: :ghost, size: :sm) %>
      <%= render FlatPack::Button::Component.new(text: "Share", style: :secondary, size: :sm) %>
    <% end %>
  <% end %>

  <%= render FlatPack::CodeBlock::Component.new(
    title: "ERB",
    language: "erb",
    code: <<~CODE
      #{erb_output_open} render FlatPack::Chart::Component.new(
        type: :line,
        series: [{name: "Users", data: [10, 25, 42, 68, 95, 130, 178, 220]}],
        title: "User Growth",
        subtitle: "Last 8 months",
        height: 300
      ) do |chart| #{erb_tag_close}
        #{erb_output_open} chart.actions do #{erb_tag_close}
          #{erb_output_open} render FlatPack::Button::Component.new(text: "Export", style: :ghost, size: :sm) #{erb_tag_close}
          #{erb_output_open} render FlatPack::Button::Component.new(text: "Share", style: :secondary, size: :sm) #{erb_tag_close}
        #{erb_open} end #{erb_tag_close}
      #{erb_open} end #{erb_tag_close}
    CODE
  ) %>
</section>

<!-- Chart without Card -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Chart without Card Wrapper", anchor_link: true, subtitle: "Examples for Chart without Card Wrapper.") %>
  <p class="text-muted-foreground mb-4">
    Set <code>card: false</code> to render the chart without a card wrapper.
  </p>
  <%= render FlatPack::Chart::Component.new(
    type: :bar,
    series: [{name: "Traffic", data: [12, 19, 3, 5, 2, 3]}],
    card: false,
    height: 250
  ) %>

  <%= render FlatPack::CodeBlock::Component.new(
    title: "ERB",
    language: "erb",
    code: <<~CODE
      #{erb_output_open} render FlatPack::Chart::Component.new(
        type: :bar,
        series: [{name: "Traffic", data: [12, 19, 3, 5, 2, 3]}],
        card: false,
        height: 250
      ) #{erb_tag_close}
    CODE
  ) %>
</section>

<!-- Multiple Charts in Grid -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Multiple Charts in Grid", anchor_link: true, subtitle: "Examples for Multiple Charts in Grid.") %>
  <%= render FlatPack::Grid::Component.new(cols: 2) do %>
    <%= render FlatPack::Chart::Component.new(
      type: :line,
      series: [{name: "Visits", data: [30, 40, 35, 50, 49, 60, 70, 91]}],
      title: "Website Visits",
      height: 250
    ) %>
    
    <%= render FlatPack::Chart::Component.new(
      type: :bar,
      series: [{name: "Conversions", data: [5, 8, 6, 10, 9, 12, 15, 18]}],
      title: "Conversions",
      height: 250
    ) %>
  <% end %>

  <%= render FlatPack::CodeBlock::Component.new(
    title: "ERB",
    language: "erb",
    code: <<~CODE
      #{erb_output_open} render FlatPack::Grid::Component.new(cols: 2) do #{erb_tag_close}
        #{erb_output_open} render FlatPack::Chart::Component.new(
          type: :line,
          series: [{name: "Visits", data: [30, 40, 35, 50, 49, 60, 70, 91]}],
          title: "Website Visits",
          height: 250
        ) #{erb_tag_close}

        #{erb_output_open} render FlatPack::Chart::Component.new(
          type: :bar,
          series: [{name: "Conversions", data: [5, 8, 6, 10, 9, 12, 15, 18]}],
          title: "Conversions",
          height: 250
        ) #{erb_tag_close}
      #{erb_open} end #{erb_tag_close}
    CODE
  ) %>
</section>

<!-- Chart with Footer -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Chart with Footer", anchor_link: true, subtitle: "Examples for Chart with Footer.") %>
  <%= render FlatPack::Chart::Component.new(
    type: :area,
    series: [{name: "Revenue", data: [10, 20, 15, 30, 25, 40, 35, 50]}],
    title: "Revenue Trend",
    height: 300
  ) do |chart| %>
    <% chart.footer do %>
      <div class="flex items-center justify-between text-sm">
        <div class="flex items-center gap-4">
          <div>
            <span class="text-muted-foreground">Total:</span>
            <span class="font-semibold ml-1">$225K</span>
          </div>
          <div>
            <span class="text-muted-foreground">Avg:</span>
            <span class="font-semibold ml-1">$28.1K</span>
          </div>
        </div>
        <span class="text-green-600 font-semibold">+12.5% vs last period</span>
      </div>
    <% end %>
  <% end %>

  <%= render FlatPack::CodeBlock::Component.new(
    title: "ERB",
    language: "erb",
    code: <<~CODE
      #{erb_output_open} render FlatPack::Chart::Component.new(
        type: :area,
        series: [{name: "Revenue", data: [10, 20, 15, 30, 25, 40, 35, 50]}],
        title: "Revenue Trend",
        height: 300
      ) do |chart| #{erb_tag_close}
        #{erb_output_open} chart.footer do #{erb_tag_close}
          <div class="flex items-center justify-between text-sm">
            <div class="flex items-center gap-4">
              <div>
                <span class="text-muted-foreground">Total:</span>
                <span class="font-semibold ml-1">$225K</span>
              </div>
              <div>
                <span class="text-muted-foreground">Avg:</span>
                <span class="font-semibold ml-1">$28.1K</span>
              </div>
            </div>
            <span class="text-green-600 font-semibold">+12.5% vs last period</span>
          </div>
        #{erb_open} end #{erb_tag_close}
      #{erb_open} end #{erb_tag_close}
    CODE
  ) %>
</section>

<!-- Setup Instructions -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Setup Instructions", anchor_link: true, subtitle: "Examples for Setup Instructions.") %>
  <h3 class="text-lg font-semibold mb-3">ApexCharts is Already Configured</h3>
  <p class="text-muted-foreground mb-4">
    FlatPack includes ApexCharts via CDN in the importmap. No additional setup required!
  </p>
  
  <%= render FlatPack::CodeBlock::Component.new(
    code: CGI.unescapeHTML(<<~'CODE'),
      # config/importmap.rb (already configured)
      pin "apexcharts", to: "https://cdn.jsdelivr.net/npm/apexcharts@3.45.1/dist/apexcharts.esm.js"
    CODE
    class: "mb-4"
  ) %>
  
  <h3 class="text-lg font-semibold mb-3">For Self-Hosting (Production)</h3>
  <%= render FlatPack::CodeBlock::Component.new(
    code: CGI.unescapeHTML(<<~'CODE')
      # Download and place in vendor/javascript
      # Then update importmap.rb
      pin "apexcharts", to: "apexcharts.min.js"
    CODE
  ) %>
</section>

<!-- Custom Options -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Custom ApexCharts Options", anchor_link: true, subtitle: "Examples for Custom ApexCharts Options.") %>
  <p class="text-muted-foreground mb-4">
    Pass custom ApexCharts options for full control.
  </p>
  
  <%= render FlatPack::CodeBlock::Component.new(
    code: CGI.unescapeHTML(<<~'CODE')
      &lt;%= render FlatPack::Chart::Component.new(
        type: :line,
        series: [{name: "Sales", data: [30, 40, 45]}],
        options: {
          chart: {
            toolbar: { show: true }
          },
          colors: ['#FF5733'],
          stroke: {
            width: 3,
            curve: 'smooth'
          },
          xaxis: {
            categories: ['Jan', 'Feb', 'Mar']
          }
        }
      ) %&gt;
    CODE
  ) %>
</section>

<!-- Features -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Features", anchor_link: true, subtitle: "Examples for Features.") %>
  <ul class="list-disc list-inside space-y-2 text-foreground">
    <li><strong>ApexCharts Integration:</strong> Professional data visualization library</li>
    <li><strong>Lazy Loading:</strong> Charts load only when needed (via dynamic import)</li>
    <li><strong>Card Wrapping:</strong> Automatic card wrapper with title, actions, footer</li>
    <li><strong>6 Chart Types:</strong> Line, bar, area, donut, pie, and more</li>
    <li><strong>Responsive:</strong> Charts adapt to container size</li>
    <li><strong>Turbo Compatible:</strong> Properly cleans up on navigation</li>
    <li><strong>Customizable:</strong> Full access to ApexCharts options</li>
    <li><strong>Accessible:</strong> Works with screen readers</li>
  </ul>
</section>

<!-- Chart Types Reference -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Available Chart Types", anchor_link: true, subtitle: "Examples for Available Chart Types.") %>
  <div class="grid grid-cols-2 md:grid-cols-3 gap-3">
    <%= render FlatPack::Badge::Component.new(text: ":line", variant: :default) %>
    <%= render FlatPack::Badge::Component.new(text: ":bar", variant: :default) %>
    <%= render FlatPack::Badge::Component.new(text: ":area", variant: :default) %>
    <%= render FlatPack::Badge::Component.new(text: ":donut", variant: :default) %>
    <%= render FlatPack::Badge::Component.new(text: ":pie", variant: :default) %>
    <%= render FlatPack::Badge::Component.new(text: ":radial", variant: :default) %>
  </div>
</section>
