<%= render FlatPack::PageTitle::Component.new(
  title: "Modal Component",
  subtitle: "Accessible dialog overlays with focus trap, backdrop dismiss, and ESC key support."
) %>

<!-- Basic Modal -->
<%= render "pages/component_method_variables_table", component: :modal %>
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Basic Modal", anchor_link: true, subtitle: "Examples for Basic Modal.") %>
  <div class="mb-4">
    <%= render FlatPack::Button::Component.new(
      text: "Open Modal",
      style: :primary,
      data: { action: "click->flat-pack--modal#open", "modal-id": "basic-modal" }
    ) %>
  </div>
  
  <%= render FlatPack::Modal::Component.new(id: "basic-modal", size: :md) do |modal| %>
    <% modal.with_header do %>
      <h2 class="text-xl font-semibold">Modal Title</h2>
    <% end %>
    <% modal.with_body do %>
      <p class="text-foreground">
        This is a basic modal dialog. Click the backdrop, press ESC, or click the close button to dismiss.
      </p>
      <p class="mt-4 text-muted-foreground">
        The modal traps focus and prevents interaction with the rest of the page while open.
      </p>
    <% end %>
    <% modal.with_footer do %>
      <%= render FlatPack::Button::Component.new(
        text: "Cancel",
        style: :secondary,
        data: { action: "click->flat-pack--modal#close" }
      ) %>
      <%= render FlatPack::Button::Component.new(
        text: "Confirm",
        style: :primary,
        data: { action: "click->flat-pack--modal#close" }
      ) %>
    <% end %>
  <% end %>
  
  <%= render FlatPack::CodeBlock::Component.new(
    code: CGI.unescapeHTML(<<~'CODE')
      &lt;%= render FlatPack::Modal::Component.new(id: "basic-modal", size: :md) do |modal| %&gt;
        &lt;% modal.with_header do %&gt;
          <h2>Modal Title</h2>
        &lt;% end %&gt;
        &lt;% modal.with_body do %&gt;
          <p>Modal content goes here...</p>
        &lt;% end %&gt;
        &lt;% modal.with_footer do %&gt;
          &lt;%= render FlatPack::Button::Component.new(
            text: "Close",
            data: { action: "click->flat-pack--modal#close" }
          ) %&gt;
        &lt;% end %&gt;
      &lt;% end %&gt;
    CODE
  ) %>
</section>

<!-- Modal Sizes -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Modal Sizes", anchor_link: true, subtitle: "Examples for Modal Sizes.") %>
  <div class="flex gap-3 mb-4">
    <%= render FlatPack::Button::Component.new(
      text: "Small Modal",
      style: :secondary,
      data: { action: "click->flat-pack--modal#open", "flat-pack--modal-target": "trigger", "modal-id": "small-modal" }
    ) %>
    <%= render FlatPack::Button::Component.new(
      text: "Medium Modal",
      style: :secondary,
      data: { action: "click->flat-pack--modal#open", "flat-pack--modal-target": "trigger", "modal-id": "medium-modal" }
    ) %>
    <%= render FlatPack::Button::Component.new(
      text: "Large Modal",
      style: :secondary,
      data: { action: "click->flat-pack--modal#open", "flat-pack--modal-target": "trigger", "modal-id": "large-modal" }
    ) %>
  </div>
  
  <%= render FlatPack::Modal::Component.new(id: "small-modal", size: :sm) do |modal| %>
    <% modal.with_header do %>
      <h2 class="text-xl font-semibold">Small Modal</h2>
    <% end %>
    <% modal.with_body do %>
      <p>This is a small modal with limited width.</p>
    <% end %>
    <% modal.with_footer do %>
      <%= render FlatPack::Button::Component.new(text: "Close", style: :secondary, data: { action: "click->flat-pack--modal#close" }) %>
    <% end %>
  <% end %>
  
  <%= render FlatPack::Modal::Component.new(id: "medium-modal", size: :md) do |modal| %>
    <% modal.with_header do %>
      <h2 class="text-xl font-semibold">Medium Modal (Default)</h2>
    <% end %>
    <% modal.with_body do %>
      <p>This is a medium-sized modal, which is the default size.</p>
    <% end %>
    <% modal.with_footer do %>
      <%= render FlatPack::Button::Component.new(text: "Close", style: :secondary, data: { action: "click->flat-pack--modal#close" }) %>
    <% end %>
  <% end %>
  
  <%= render FlatPack::Modal::Component.new(id: "large-modal", size: :lg) do |modal| %>
    <% modal.with_header do %>
      <h2 class="text-xl font-semibold">Large Modal</h2>
    <% end %>
    <% modal.with_body do %>
      <p>This is a large modal with more width for complex content.</p>
    <% end %>
    <% modal.with_footer do %>
      <%= render FlatPack::Button::Component.new(text: "Close", style: :secondary, data: { action: "click->flat-pack--modal#close" }) %>
    <% end %>
  <% end %>
  
  <%= render FlatPack::CodeBlock::Component.new(
    code: CGI.unescapeHTML(<<~'CODE')
      &lt;%= render FlatPack::Modal::Component.new(id: "my-modal", size: :sm) ... %&gt;
      &lt;%= render FlatPack::Modal::Component.new(id: "my-modal", size: :md) ... %&gt;
      &lt;%= render FlatPack::Modal::Component.new(id: "my-modal", size: :lg) ... %&gt;
    CODE
  ) %>
</section>

<!-- Modal with Form -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Modal with Form", anchor_link: true, subtitle: "Examples for Modal with Form.") %>
  <p class="text-muted-foreground mb-4">
    A practical example of placing a form inside a modal for focused data entry.
  </p>
  <div class="mb-4">
    <%= render FlatPack::Button::Component.new(
      text: "Open Form Modal",
      style: :primary,
      data: { action: "click->flat-pack--modal#open", "modal-id": "form-modal" }
    ) %>
  </div>

  <%= render FlatPack::Modal::Component.new(id: "form-modal", size: :md) do |modal| %>
    <% modal.with_header do %>
      <h2 class="text-xl font-semibold">Contact Sales</h2>
    <% end %>
    <% modal.with_body do %>
      <form class="space-y-4">
        <%= render FlatPack::TextInput::Component.new(
          name: "contact[name]",
          label: "Name",
          placeholder: "Jane Doe",
          required: true
        ) %>

        <%= render FlatPack::EmailInput::Component.new(
          name: "contact[email]",
          label: "Work Email",
          placeholder: "jane@company.com",
          required: true
        ) %>

        <%= render FlatPack::TextArea::Component.new(
          name: "contact[message]",
          label: "Message",
          placeholder: "Tell us what you'd like to build...",
          rows: 3,
          required: true
        ) %>

        <div class="flex justify-end gap-2 pt-2">
          <%= render FlatPack::Button::Component.new(
            text: "Cancel",
            style: :secondary,
            data: { action: "click->flat-pack--modal#close" }
          ) %>
          <%= render FlatPack::Button::Component.new(
            text: "Submit",
            style: :primary,
            data: { action: "click->flat-pack--modal#close" }
          ) %>
        </div>
    <% end %>
  <% end %>

  <%= render FlatPack::CodeBlock::Component.new(
    code: CGI.unescapeHTML(<<~'CODE')
      &lt;%= render FlatPack::Modal::Component.new(id: "form-modal", size: :md) do |modal| %&gt;
        &lt;% modal.with_header do %&gt;
          <h2>Contact Sales</h2>
        &lt;% end %&gt;
        &lt;% modal.with_body do %&gt;
          <form class="space-y-4">
            &lt;%= render FlatPack::TextInput::Component.new(...) %&gt;
            &lt;%= render FlatPack::EmailInput::Component.new(...) %&gt;
            &lt;%= render FlatPack::TextArea::Component.new(...) %&gt;
            <div class="flex justify-end gap-2 pt-2">
              &lt;%= render FlatPack::Button::Component.new(text: "Cancel", style: :secondary, data: { action: "click->flat-pack--modal#close" }) %&gt;
              &lt;%= render FlatPack::Button::Component.new(text: "Submit", style: :primary, data: { action: "click->flat-pack--modal#close" }) %&gt;
            </div>
          </form>
        &lt;% end %&gt;
      &lt;% end %&gt;
    CODE
  ) %>
</section>

<!-- Long Content Modal -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Long Content Modal", anchor_link: true, subtitle: "Examples for Long Content Modal.") %>
  <p class="text-muted-foreground mb-4">
    This example includes a large amount of text to test modal body scrolling and overall behavior with long-form content.
  </p>
  <div class="mb-4">
    <%= render FlatPack::Button::Component.new(
      text: "Open Long Content Modal",
      style: :secondary,
      data: { action: "click->flat-pack--modal#open", "flat-pack--modal-target": "trigger", "modal-id": "long-content-modal" }
    ) %>
  </div>

  <%= render FlatPack::Modal::Component.new(id: "long-content-modal", size: :lg) do |modal| %>
    <% modal.with_header do %>
      <h2 class="text-xl font-semibold">Long Content Test</h2>
    <% end %>
    <% modal.with_body do %>
      <div class="space-y-4 text-foreground">
        <p>
          This modal intentionally contains a lot of text so you can validate scrolling behavior, focus handling,
          and layout stability with larger content sets.
        </p>
        <% 20.times do |i| %>
          <p>
            <strong>Section <%= i + 1 %>:</strong>
            Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus at augue vitae lacus consequat feugiat.
            Curabitur suscipit, est in dapibus rhoncus, nisi lectus congue turpis, at interdum turpis dui eget nibh.
            Integer facilisis velit ac tellus feugiat, non aliquet elit convallis. Aenean tempor sem ut neque luctus,
            vitae pulvinar ipsum sodales.
          </p>
        <% end %>
      </div>
    <% end %>
    <% modal.with_footer do %>
      <%= render FlatPack::Button::Component.new(
        text: "Close",
        style: :secondary,
        data: { action: "click->flat-pack--modal#close" }
      ) %>
    <% end %>
  <% end %>
</section>

<!-- Features -->
<section class="mb-12">
  <%= render FlatPack::SectionTitle::Component.new(title: "Features", anchor_link: true, subtitle: "Examples for Features.") %>
  <ul class="list-disc list-inside space-y-2 text-foreground">
    <li><strong>Focus Trap:</strong> Keeps keyboard focus within the modal while open</li>
    <li><strong>Focus Restoration:</strong> Returns focus to the trigger element on close</li>
    <li><strong>ESC to Close:</strong> Press ESC key to dismiss the modal</li>
    <li><strong>Backdrop Click:</strong> Click outside the modal to close (configurable)</li>
    <li><strong>Scroll Prevention:</strong> Prevents page scrolling while modal is open</li>
    <li><strong>Accessibility:</strong> Full ARIA support with role="dialog" and aria-modal="true"</li>
    <li><strong>Animations:</strong> Smooth fade and scale transitions (respects prefers-reduced-motion)</li>
    <li><strong>Turbo Compatible:</strong> Works seamlessly with Turbo navigation</li>
  </ul>
</section>
